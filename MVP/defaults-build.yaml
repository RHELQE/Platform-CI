- defaults:
    name: defaults-build
    node: 'jslave-platform-rhel7'
    wrappers:
        - ansicolor
        - workspace-cleanup
        - timestamps
        - build-name:
            name: ${{ENV,var="name"}}-${{ENV,var="version"}}-${{ENV,var="release"}}
    publishers:
        - postbuildscript:
          script-only-if-succeeded: False
          script-only-if-failed: True
          builders:
            - shell: |
                #!/bin/bash
                echo "Jenkins job failed or canceled - canceling any submitted Beaker jobs"
                BKR_JOBID=`cut -d\' -f2 $WORKSPACE/bkr_job.txt`
                bkr job-cancel ${{BKR_JOBID}}
        - archive:
            artifacts: '*.txt, *.xml'
            allow-empty: 'true'
        - junit:
            results: 'J:*.xml'
        - email-ext:
            recipients: ${{OWNERSHIP,var="JOB_COOWNERS_EMAILS"}}
            always: true
            failure: false
            send-to:
                - recipients
